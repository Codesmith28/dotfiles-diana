---
- name: Detect GPU
  ansible.builtin.shell: set -o pipefail && lspci | grep -i 'VGA\|3D\|display'
  register: gpu_result
  changed_when: no

- name: Check if you have a nvidia card for additional configuration
  set_fact:
    is_nvidia: "{{ 'nvidia' in gpu_result.stdout.lower() }}"

- name: "GPU Drivers | Checking for Distribution Config: {{ ansible_distribution }}"
  ansible.builtin.stat:
    path: "pre_tasks/gpu_drivers/{{ ansible_distribution }}.yml"
  register: gpu_drivers_distribution_config

- name: "GPU Drivers | Run Tasks: {{ ansible_distribution }}"
  ansible.builtin.include_tasks: "{{ ansible_distribution }}.yml"
  when: gpu_drivers_distribution_config.stat.exists
